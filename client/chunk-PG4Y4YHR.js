import{a as re}from"./chunk-DKZNCK5F.js";import{a as _e,c as I,d as M,e as F,f as O,h as L,i as le,j as V,l as R,m as ce,n as se,o as de,q,s as P,t as N}from"./chunk-UA7LSEX7.js";import{$ as b,Aa as D,Ba as p,D as ee,J as l,M as E,Na as ie,Oa as ae,R as W,X as d,Y as m,Ya as oe,a as k,aa as S,ba as A,ca as i,da as a,ea as v,f as he,fa as h,ga as g,kb as T,la as y,lb as G,na as u,oa as te,pa as s,pb as w,v as _,w as f,x,xa as U,y as X,ya as ne,z as Z,za as o}from"./chunk-FUTAJFPZ.js";function fe(n,t){n&1&&(i(0,"span"),o(1,"Group Name is required."),a())}function xe(n,t){if(n&1&&(i(0,"span"),o(1),a()),n&2){let e=s(2);l(),p(" Group Name cannot exceed ",e.groupName==null||e.groupName.errors==null||e.groupName.errors.maxlength==null?null:e.groupName.errors.maxlength.requiredLength," characters. ")}}function ge(n,t){if(n&1&&(i(0,"div",13),d(1,fe,2,0,"span"),d(2,xe,2,1,"span"),a()),n&2){let e=s();l(),m(!(e.groupName==null||e.groupName.errors==null)&&e.groupName.errors.required?1:-1),l(),m(!(e.groupName==null||e.groupName.errors==null)&&e.groupName.errors.maxlength?2:-1)}}var $=class n{_coreService=_(w);_apiFs=_(N);_fb=_(q);isEditMode=!1;machineGroupData;closeOrCancel=new W;upsert=new W;mgForm=this._fb.group({groupName:["",[M.required,M.maxLength(120)]]});ngOnChanges(t){t.machineGroupData?.currentValue&&(this.isEditMode=!!t.machineGroupData?.currentValue?._id,this.mgForm.patchValue({groupName:this.machineGroupData?.groupName||""}))}get groupName(){return this.mgForm.get("groupName")}isReqAlive=!1;onSubmit(){if(this.isReqAlive)return;if(this.mgForm.invalid){this.mgForm.markAllAsTouched();return}let t={groupName:this.groupName?.value};if(console.log("Submitting workspace form with data:",t),this.isReqAlive=!0,!this.isEditMode)this._apiFs.machineGroup.create(t).subscribe({next:e=>{this.isReqAlive=!1,e.code==="CREATED"&&(this._coreService.utils.showToaster("success","Machine Group created successfully."),this.upsert.emit(!0))},error:e=>{this.isReqAlive=!1;let r=e?.error?.message||"Something went wrong, please try again later.";this._coreService.utils.showToaster("danger",r)}});else{let e=this.machineGroupData?._id;if(!e){this.isReqAlive=!1,this._coreService.utils.showToaster("danger","Machine Group ID is missing.");return}this._apiFs.machineGroup.update(e,t).subscribe({next:r=>{this.isReqAlive=!1,r.code==="OK"&&(this._coreService.utils.showToaster("success","Machine Group updated successfully."),this.upsert.emit(r.data))},error:r=>{this.isReqAlive=!1;let c=r?.error?.message||"Something went wrong, please try again later.";this._coreService.utils.showToaster("danger",c)}})}}onCloseOrCancel(){this.closeOrCancel.emit()}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=E({type:n,selectors:[["app-upsert-machine-group"]],inputs:{machineGroupData:"machineGroupData"},outputs:{closeOrCancel:"close",upsert:"upsert"},features:[ee],decls:22,vars:4,consts:[[1,"modal","d-block"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content","shadow-lg"],[3,"ngSubmit","formGroup"],[1,"modal-header"],[1,"modal-title","fs-5"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"row"],[1,"col-12","mb-3"],["for","groupName",1,"form-label"],[1,"text-danger"],["type","text","id","groupName","formControlName","groupName","placeholder","Enter Group Name",1,"form-control"],[1,"invalid-feedback","d-block"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary","me-3",3,"click"],[1,"btn","btn-primary"]],template:function(e,r){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"form",3),u("ngSubmit",function(){return r.onSubmit()}),i(4,"div",4)(5,"h1",5),o(6),a(),i(7,"button",6),u("click",function(){return r.onCloseOrCancel()}),a()(),i(8,"div",7)(9,"div",8)(10,"div",9)(11,"label",10),o(12," Group Name "),i(13,"span",11),o(14,"*"),a()(),v(15,"input",12),d(16,ge,3,2,"div",13),a()()(),i(17,"div",14)(18,"button",15),u("click",function(){return r.onCloseOrCancel()}),o(19," Cancel "),a(),i(20,"button",16),o(21),a()()()()()()),e&2&&(l(3),A("formGroup",r.mgForm),l(3),p(" ",r.isEditMode?"Edit ":"Create ","Machine Group "),l(10),m(r.groupName!=null&&r.groupName.touched&&(r.groupName!=null&&r.groupName.errors)?16:-1),l(5),p(" ",r.isEditMode?"Update":"Create"," "))},dependencies:[P,L,I,F,O,V,R],encapsulation:2})};var Ce=(n,t)=>t._id;function Me(n,t){if(n&1){let e=y();i(0,"tr")(1,"th",14),o(2),a(),i(3,"td",15),o(4),a(),i(5,"td")(6,"button",16),u("click",function(){let c=f(e).$implicit,C=s();return x(C.onOpenUpsertWorkspaceModal(c))}),o(7," Edit "),a()()()}if(n&2){let e=t.$implicit,r=t.$index;l(2),D(r+1),l(2),p(" ",e==null?null:e.groupName," ")}}function ve(n,t){n&1&&(i(0,"tr")(1,"td",17),o(2," No records found. "),a()())}function ye(n,t){if(n&1){let e=y();i(0,"app-upsert-machine-group",18),u("close",function(){f(e);let c=s();return x(c.onCloseMachineGroupModal())})("upsert",function(c){f(e);let C=s();return x(C.upsertMachineGroupModalEvent(c))}),a()}if(n&2){let e=s();A("machineGroupData",e.upsertMachineGroupModalData)}}var Y=class n{_coreService=_(w);_apiFs=_(N);upsertMachineGroupModalData;isUpsertMachineGroupModalOpen=!1;ngOnInit(){this.loadList()}machineGroupList=[];loadList(){this._apiFs.machineGroup.list().subscribe({next:t=>{t.code==="OK"&&(this.machineGroupList=t.data||[])},error:t=>{}})}onOpenUpsertWorkspaceModal(t=null){this.upsertMachineGroupModalData=t,this.isUpsertMachineGroupModalOpen=!0}onCloseMachineGroupModal(){this.isUpsertMachineGroupModalOpen=!1}upsertMachineGroupModalEvent(t){let e=t?this.machineGroupList.findIndex(r=>r._id===t._id):-1;e>-1?this.machineGroupList[e]=t:this.loadList(),this.onCloseMachineGroupModal()}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=E({type:n,selectors:[["app-machine-group"]],decls:27,vars:2,consts:[[1,"container-xxl","p-3","my-4","bg-white","shadow-sm","rounded-2","border"],[1,"table-responsive"],[1,"table","caption-top","table-striped","table-hover"],[1,"d-flex","align-items-center","justify-content-between","gap-2","flex-wrap"],[1,"text-capitialise","fs-5"],[1,"btn","btn-outline-primary","btn-sm","d-flex","align-items-center","gap-1",3,"click"],["height","18","width","18","viewBox","0 0 48 48",1,"flex-shrink-0"],["fill","none","stroke","currentColor","stroke-miterlimit","10","stroke-width","4","stroke-linecap","round","x1","8","x2","40","y1","24","y2","24"],["fill","none","stroke","currentColor","stroke-miterlimit","10","stroke-width","4","stroke-linecap","round","x1","24","x2","24","y1","8","y2","40"],[1,"text-nowrap"],[1,"table-dark","bg-opacity-50"],["scope","col",1,"w-1-percent"],["scope","col",1,"text-nowrap"],[3,"machineGroupData"],["scope","row"],[1,"text-capitalize"],[1,"btn","btn-outline-primary","btn-sm",3,"click"],["colspan","3",1,"text-muted","small","text-center"],[3,"close","upsert","machineGroupData"]],template:function(e,r){e&1&&(i(0,"div",0)(1,"div",1)(2,"table",2)(3,"caption")(4,"div",3)(5,"strong",4),o(6," Machine Group "),a(),i(7,"div")(8,"button",5),u("click",function(){return r.onOpenUpsertWorkspaceModal()}),X(),i(9,"svg",6),v(10,"line",7)(11,"line",8),a(),Z(),i(12,"span",9),o(13," New Machine Group "),a()()()()(),i(14,"thead",10)(15,"tr")(16,"th",11),o(17,"#"),a(),i(18,"th",12),o(19," Group Name "),a(),i(20,"th",11),o(21," Action "),a()()(),i(22,"tbody"),b(23,Me,8,2,"tr",null,Ce,!1,ve,3,0,"tr"),a()()()(),d(26,ye,1,1,"app-upsert-machine-group",13)),e&2&&(l(23),S(r.machineGroupList),l(3),m(r.isUpsertMachineGroupModalOpen?26:-1))},dependencies:[$],encapsulation:2})};var pe=(n,t)=>t._id;function Ee(n,t){if(n&1){let e=y();i(0,"tr")(1,"th",8),o(2),a(),i(3,"td",9),o(4),a(),i(5,"td",9),o(6),a(),i(7,"td",9),o(8),a(),i(9,"td",9),o(10),a(),i(11,"td",9)(12,"div",10),u("click",function(){let c=f(e).$implicit,C=s();return x(C.onToggleAlert(c))}),i(13,"span",11)(14,"span",12),o(15),a()()()(),i(16,"td")(17,"button",13),u("click",function(){let c=f(e).$implicit,C=s();return x(C.onOpenUpsertMachineConfigureModal(c))}),o(18," Edit "),a()()()}if(n&2){let e=t.$implicit,r=t.$index;l(2),D(r+1),l(2),p(" ",e==null?null:e.machineCode," "),l(2),p(" ",e==null?null:e.machineName," "),l(2),p(" ",(e==null||e.machineGroupId==null?null:e.machineGroupId.groupName)||"-"," "),l(2),p(" ",e==null?null:e.ip," "),l(2),U("on",e.isAlertActive),l(3),p(" ",e.isAlertActive?"On":"Off"," ")}}function be(n,t){n&1&&(i(0,"tr")(1,"td",14),o(2," No records found. "),a()())}function Se(n,t){n&1&&(i(0,"span"),o(1,"Group Name is required."),a())}function we(n,t){n&1&&(i(0,"span"),o(1," Machine Code must start with 'M' followed by numbers only. "),a())}function Ne(n,t){if(n&1&&(i(0,"div",29),d(1,Se,2,0,"span"),d(2,we,2,0,"span"),a()),n&2){let e=s(2);l(),m(!(e.machineCode==null||e.machineCode.errors==null)&&e.machineCode.errors.required?1:-1),l(),m(!(e.machineCode==null||e.machineCode.errors==null)&&e.machineCode.errors.pattern?2:-1)}}function Ae(n,t){if(n&1&&(i(0,"option",33),o(1),a()),n&2){let e=t.$implicit;A("value",e==null?null:e._id),l(),p(" ",e==null?null:e.groupName," ")}}function ke(n,t){n&1&&(i(0,"span"),o(1,"Machine Max Speed is required."),a())}function De(n,t){if(n&1&&(i(0,"span"),o(1),a()),n&2){let e=s(3);l(),p(" Enter at least ",e.maxSpeedLimit==null||e.maxSpeedLimit.errors==null||e.maxSpeedLimit.errors.min==null?null:e.maxSpeedLimit.errors.min.min," for machine speed. ")}}function Te(n,t){if(n&1&&(i(0,"div",29),d(1,ke,2,0,"span"),d(2,De,2,1,"span"),a()),n&2){let e=s(2);l(),m(!(e.maxSpeedLimit==null||e.maxSpeedLimit.errors==null)&&e.maxSpeedLimit.errors.required?1:-1),l(),m(!(e.maxSpeedLimit==null||e.maxSpeedLimit.errors==null)&&e.maxSpeedLimit.errors.min?2:-1)}}function Ge(n,t){if(n&1){let e=y();i(0,"div",7)(1,"div",15)(2,"div",16)(3,"form",17),u("ngSubmit",function(){f(e);let c=s();return x(c.upsertMachineConfigure())}),i(4,"div",18)(5,"h1",19),o(6," Edit Machine Configuration "),a(),i(7,"button",20),u("click",function(){f(e);let c=s();return x(c.onCloseMachineConfigureModal())}),a()(),i(8,"div",21)(9,"div",22)(10,"div",23)(11,"label",24),o(12," Company Name "),i(13,"span",25),o(14,"*"),a()(),v(15,"input",26),a(),i(16,"div",23)(17,"label",27),o(18," Machine Code "),i(19,"span",25),o(20,"*"),a()(),v(21,"input",28),d(22,Ne,3,2,"div",29),a(),i(23,"div",23)(24,"label",30),o(25," Machine Group Name "),a(),i(26,"select",31)(27,"option",32),o(28,"Select Machine Group"),a(),b(29,Ae,2,2,"option",33,pe),a()(),i(31,"div",23)(32,"label",34),o(33," Machine Max Speed Limit "),a(),v(34,"input",35),d(35,Te,3,2,"div",29),a(),i(36,"div",36)(37,"span",37),o(38," Alert "),a(),i(39,"div",10),u("click",function(){f(e);let c=s();return x(c.onChangeAlert())}),i(40,"span",38)(41,"span",12),o(42),a()()()()()(),i(43,"div",39)(44,"button",40),u("click",function(){f(e);let c=s();return x(c.onCloseMachineConfigureModal())}),o(45," Cancel "),a(),i(46,"button",41),o(47," Update "),a()()()()()()}if(n&2){let e=s();l(3),A("formGroup",e.mcForm),l(19),m(e.machineCode!=null&&e.machineCode.touched&&(e.machineCode!=null&&e.machineCode.errors)?22:-1),l(7),S(e.machineGroupList),l(6),m(e.maxSpeedLimit!=null&&e.maxSpeedLimit.touched&&(e.maxSpeedLimit!=null&&e.maxSpeedLimit.errors)?35:-1),l(4),U("on",e.isAlertActive==null?null:e.isAlertActive.value),l(3),p(" ",e.isAlertActive!=null&&e.isAlertActive.value?"On":"Off"," ")}}var j=class n{_coreService=_(w);_apiFs=_(N);_fb=_(q);upsertMachineConfigureModalData;isUpsertMachineConfigureModalOpen=!1;mcForm=this._fb.group({machineName:["",[]],machineCode:["",[M.required,M.pattern("^M[0-9]+$")]],machineGroupId:["",[]],maxSpeedLimit:[null,[M.min(0)]],isAlertActive:[!1,[]]});ngOnInit(){this.loadList(),this.loadMachineGroupList()}machineConfigureList=[];loadList(){this._apiFs.machineConfigure.list().subscribe({next:t=>{t.code==="OK"&&(this.machineConfigureList=t.data||[])},error:t=>{}})}machineGroupList=[];selectedMachineGroup;loadMachineGroupList(){this._apiFs.machineGroup.list().subscribe({next:t=>{t.code==="OK"&&(this.machineGroupList=t.data||[])},error:t=>{}})}get machineName(){return this.mcForm.get("machineName")}get machineCode(){return this.mcForm.get("machineCode")}get machineGroupId(){return this.mcForm.get("machineGroupId")}get maxSpeedLimit(){return this.mcForm.get("maxSpeedLimit")}get isAlertActive(){return this.mcForm.get("isAlertActive")}onChangeAlert(){this.isAlertActive?.patchValue(!this.isAlertActive.value)}onOpenUpsertMachineConfigureModal(t){t&&(this.upsertMachineConfigureModalData=t,this.mcForm.patchValue({machineName:t?.machineName??"",machineCode:t?.machineCode??"",machineGroupId:t?.machineGroupId?._id??"",maxSpeedLimit:t?.maxSpeedLimit??null,isAlertActive:t?.isAlertActive??!1}),this.machineName?.disable(),this.isUpsertMachineConfigureModalOpen=!0)}onCloseMachineConfigureModal(){this.isUpsertMachineConfigureModalOpen=!1,this.upsertMachineConfigureModalData=null,this.mcForm.reset({machineName:"",machineCode:"",machineGroupId:"",maxSpeedLimit:null,isAlertActive:!1})}isReqAlive=!1;upsertMachineConfigure(){if(this.isReqAlive||!this.upsertMachineConfigureModalData?._id)return;if(this.mcForm?.invalid){this.mcForm.markAllAsTouched();return}this.isReqAlive=!0;let t=k({},this.mcForm.value);t.machineGroupId=t.machineGroupId||null,this._apiFs.machineConfigure.update(this.upsertMachineConfigureModalData._id,t).subscribe({next:e=>{if(this.isReqAlive=!1,e.code==="OK"){let r=this.machineConfigureList.findIndex(c=>c._id===this.upsertMachineConfigureModalData._id);r>-1&&e.data?._id&&(this.machineConfigureList[r]=e.data),this._coreService.utils.showToaster("success","Machine configuration updated successfully."),this.onCloseMachineConfigureModal()}},error:e=>{this.isReqAlive=!1;let r=e?.error?.message||"Something went wrong, please try again later.";this._coreService.utils.showToaster("danger",r)}})}onToggleAlert(t){if(this.isReqAlive||!t?._id)return;this.isReqAlive=!0;let e={isAlertActive:!t.isAlertActive};this._apiFs.machineConfigure.update(t._id,e).subscribe({next:r=>{if(this.isReqAlive=!1,r.code==="OK"){let c=this.machineConfigureList.findIndex(C=>C._id===t._id);c>-1&&r.data?._id&&(this.machineConfigureList[c]=r.data),this._coreService.utils.showToaster("success","Alert updated successfully."),this.onCloseMachineConfigureModal()}},error:r=>{this.isReqAlive=!1;let c=r?.error?.message||"Something went wrong, please try again later.";this._coreService.utils.showToaster("danger",c)}})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=E({type:n,selectors:[["app-machine-configure"]],decls:26,vars:2,consts:[[1,"container-xxl","p-3","my-4","bg-white","shadow-sm","rounded-2","border"],[1,"table-responsive"],[1,"table","caption-top","table-striped","table-hover"],[1,"text-capitalize","fs-5","fw-bold","pt-0"],[1,"table-dark","bg-opacity-50"],["scope","col",1,"w-1-percent"],["scope","col",1,"text-nowrap"],[1,"modal","d-block"],["scope","row"],[1,"text-capitalize"],[1,"custom-switch",3,"click"],[1,"switch-track","shadow-sm"],[1,"switch-thumb"],[1,"btn","btn-outline-primary","btn-sm",3,"click"],["colspan","7",1,"text-muted","small","text-center"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content","shadow-lg"],[3,"ngSubmit","formGroup"],[1,"modal-header"],[1,"modal-title","fs-5"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"row"],[1,"col-12","mb-3"],["for","machineName",1,"form-label"],[1,"text-danger"],["type","text","id","machineName","formControlName","machineName",1,"form-control","text-capitalize"],["for","machineCode",1,"form-label"],["type","text","id","machineCode","formControlName","machineCode","placeholder","Enter Machine Code",1,"form-control"],[1,"invalid-feedback","d-block"],["for","machineGroupName",1,"form-label"],["id","machineGroupName","formControlName","machineGroupId",1,"form-select","w-100","text-capitalize"],["value","","selected",""],[3,"value"],["for","maxSpeedLimit",1,"form-label"],["type","number","id","maxSpeedLimit","formControlName","maxSpeedLimit","placeholder","Enter Machine Max Speed Limit",1,"form-control"],[1,"col-12","mb-3","d-flex","align-items-center"],[1,"form-label","me-3","mb-0"],[1,"switch-track"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary","me-3",3,"click"],[1,"btn","btn-primary"]],template:function(e,r){e&1&&(i(0,"div",0)(1,"div",1)(2,"table",2)(3,"caption",3),o(4," Machine Configure "),a(),i(5,"thead",4)(6,"tr")(7,"th",5),o(8,"#"),a(),i(9,"th",6),o(10," Machine Code "),a(),i(11,"th",6),o(12," Company Name "),a(),i(13,"th",6),o(14," Machine Group "),a(),i(15,"th",6),o(16," IP "),a(),i(17,"th",6),o(18," Alert "),a(),i(19,"th",5),o(20," Action "),a()()(),i(21,"tbody"),b(22,Ee,19,8,"tr",null,pe,!1,be,3,0,"tr"),a()()()(),d(25,Ge,48,6,"div",7)),e&2&&(l(22),S(r.machineConfigureList),l(3),m(r.isUpsertMachineConfigureModalOpen?25:-1))},dependencies:[P,L,se,de,I,le,ce,F,O,V,R],styles:[".custom-switch[_ngcontent-%COMP%]{display:inline-block;cursor:pointer;-webkit-user-select:none;user-select:none}.custom-switch[_ngcontent-%COMP%]   .switch-track[_ngcontent-%COMP%]{position:relative;display:inline-flex;align-items:center;width:3.2em;background-color:#eccdd1;border-radius:2em;transition:background-color .3s ease;padding:.2em}.custom-switch[_ngcontent-%COMP%]   .switch-track[_ngcontent-%COMP%]   .switch-thumb[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-width:2em;height:2em;color:#fff;background-color:#dc3545;border-radius:50%;transition:all .2s ease;font-size:.6em;font-weight:600}.custom-switch.on[_ngcontent-%COMP%]   .switch-track[_ngcontent-%COMP%]{background-color:#bee9bf}.custom-switch.on[_ngcontent-%COMP%]   .switch-track[_ngcontent-%COMP%]   .switch-thumb[_ngcontent-%COMP%]{background-color:#4caf50;transform:translate(2.65em)}"]})};var Ie=(n,t)=>t._id;function Fe(n,t){if(n&1){let e=y();h(0,"tr")(1,"th",8),o(2),g(),h(3,"td",9),o(4),g(),h(5,"td",9),o(6),g(),h(7,"td",9),o(8),g(),h(9,"td",9),o(10),g(),h(11,"td",10),o(12),g(),h(13,"td",9)(14,"div",11),te("click",function(){let c=f(e).$implicit,C=s();return x(C.onToggleAlert(c))}),h(15,"span",12)(16,"span",13),o(17),g()()()()()}if(n&2){let e=t.$implicit,r=t.$index;l(2),D(r+1),l(2),p(" ",e==null?null:e.name," "),l(2),p(" ",e==null?null:e.categoryType," "),l(2),p(" ",e==null?null:e.scheduleDays," "),l(2),p(" ",e==null?null:e.alertDays," "),l(2),p(" ",e==null?null:e.alertMessage," "),l(2),U("on",e.isActive),l(3),p(" ",e.isActive?"Active":"Inactive"," ")}}function Oe(n,t){n&1&&(h(0,"tr")(1,"td",14),o(2," No records found. "),g()())}var K=class n{_coreService=_(w);_apiFs=_(N);ngOnInit(){this.loadList()}maintenanceCategoryList=[];loadList(){this._apiFs.maintenanceCategory.list().subscribe({next:t=>{t.code==="OK"&&(this.maintenanceCategoryList=t.data||[])},error:t=>{}})}isReqAlive=!1;onToggleAlert(t){if(this.isReqAlive||!t?._id)return;this.isReqAlive=!0;let e={isActive:!t.isActive};this._apiFs.maintenanceCategory.update(t._id,e).subscribe({next:r=>{if(this.isReqAlive=!1,r.code==="OK"){let c=this.maintenanceCategoryList.findIndex(C=>C._id===t._id);c>-1&&r.data?._id&&(this.maintenanceCategoryList[c]=r.data),this._coreService.utils.showToaster("success","Alert updated successfully.")}},error:r=>{this.isReqAlive=!1;let c=r?.error?.message||"Something went wrong, please try again later.";this._coreService.utils.showToaster("danger",c)}})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=E({type:n,selectors:[["app-maintenance-category"]],decls:25,vars:1,consts:[[1,"container-xxl","p-3","my-4","bg-white","shadow-sm","rounded-2","border"],[1,"table-responsive"],[1,"table","caption-top","table-striped","table-hover"],[1,"text-capitalize","fs-5","fw-bold","pt-0"],[1,"table-dark","bg-opacity-50"],["scope","col",1,"w-1-percent"],["scope","col"],["scope","col",1,"text-nowrap"],["scope","row"],[1,"text-capitalize"],[1,"text-capitalize","text-danger"],[1,"custom-switch",3,"click"],[1,"switch-track","shadow-sm"],[1,"switch-thumb"],["colspan","7",1,"text-muted","small","text-center"]],template:function(e,r){e&1&&(h(0,"div",0)(1,"div",1)(2,"table",2)(3,"caption",3),o(4," Maintenance Category "),g(),h(5,"thead",4)(6,"tr")(7,"th",5),o(8,"#"),g(),h(9,"th",6),o(10," Category "),g(),h(11,"th",6),o(12," Type "),g(),h(13,"th",7),o(14," Schedule Days "),g(),h(15,"th",7),o(16," Alert Days "),g(),h(17,"th",7),o(18," Alert Message "),g(),h(19,"th",6),o(20," Status "),g()()(),h(21,"tbody"),b(22,Fe,18,9,"tr",null,Ie,!1,Oe,3,0,"tr"),g()()()()),e&2&&(l(22),S(r.maintenanceCategoryList))},styles:[".custom-switch[_ngcontent-%COMP%]{display:inline-block;cursor:pointer;-webkit-user-select:none;user-select:none}.custom-switch[_ngcontent-%COMP%]   .switch-track[_ngcontent-%COMP%]{position:relative;display:inline-flex;align-items:center;width:4.5em;background-color:#eccdd1;border-radius:2em;transition:background-color .3s ease;padding:.2em}.custom-switch[_ngcontent-%COMP%]   .switch-track[_ngcontent-%COMP%]   .switch-thumb[_ngcontent-%COMP%]{padding:0 2px;display:flex;align-items:center;justify-content:center;min-width:2em;height:2em;color:#fff;background-color:#dc3545;border-radius:1em;transition:all .2s ease;font-size:.6em;font-weight:600}.custom-switch.on[_ngcontent-%COMP%]   .switch-track[_ngcontent-%COMP%]{background-color:#bee9bf}.custom-switch.on[_ngcontent-%COMP%]   .switch-track[_ngcontent-%COMP%]   .switch-thumb[_ngcontent-%COMP%]{background-color:#4caf50;transform:translate(3.2em)}"]})};var Q=he(_e());var Le=(n,t)=>t.machineId,Ve=(n,t)=>t._id;function Re(n,t){if(n&1){let e=y();i(0,"div",12),u("click",function(){let c=f(e).$implicit,C=s().$implicit,ue=s();return x(ue.onOpenUpsertMaintenanceEntryModal(C,c))}),i(1,"span",13)(2,"span",14),o(3),a()(),i(4,"span",15),o(5),ie(6,"date"),a()()}if(n&2){let e=t.$implicit;l(3),p(" ",e==null?null:e.categoryName," "),l(),ne(e!=null&&e.isDue?"text-danger":"text-primary"),l(),p(" ",ae(6,4,e==null?null:e.nextMaintenanceDate,"dd-mm-yyyy")," ")}}function qe(n,t){if(n&1&&(i(0,"div",4)(1,"div",7)(2,"span",8),o(3),a(),i(4,"span",9),o(5),a()(),i(6,"div",10),b(7,Re,7,7,"div",11,Ve),a()()),n&2){let e=t.$implicit;l(3),p(" ",e.machineCode," "),l(2),p(" ",e.machineName," "),l(2),S(e.alerts)}}function Pe(n,t){n&1&&(i(0,"span",5),o(1," No records found. "),a())}function Ue(n,t){n&1&&(i(0,"span"),o(1,"Complete date is required."),a())}function $e(n,t){n&1&&(i(0,"span"),o(1," Complete date must be before the next maintenance date. "),a())}function Be(n,t){if(n&1&&(i(0,"div",32),d(1,Ue,2,0,"span"),d(2,$e,2,0,"span"),a()),n&2){let e=s(2);l(),m(!(e.lastMaintenanceDate==null||e.lastMaintenanceDate.errors==null)&&e.lastMaintenanceDate.errors.required?1:-1),l(),m(!(e.lastMaintenanceDate==null||e.lastMaintenanceDate.errors==null)&&e.lastMaintenanceDate.errors.lastDateInvalid?2:-1)}}function ze(n,t){n&1&&(i(0,"span"),o(1,"Next Maintenance date is required."),a())}function Ye(n,t){n&1&&(i(0,"span"),o(1," Next maintenance date must be after the last maintenance date. "),a())}function je(n,t){if(n&1&&(i(0,"div",32),d(1,ze,2,0,"span"),d(2,Ye,2,0,"span"),a()),n&2){let e=s(2);l(),m(!(e.nextMaintenanceDate==null||e.nextMaintenanceDate.errors==null)&&e.nextMaintenanceDate.errors.required?1:-1),l(),m(!(e.nextMaintenanceDate==null||e.nextMaintenanceDate.errors==null)&&e.nextMaintenanceDate.errors.nextDateInvalid?2:-1)}}function Ke(n,t){n&1&&(i(0,"span"),o(1,"Name is required."),a())}function He(n,t){n&1&&(i(0,"span"),o(1," Input cannot be empty or only spaces "),a())}function We(n,t){if(n&1&&(i(0,"div",32),d(1,Ke,2,0,"span"),d(2,He,2,0,"span"),a()),n&2){let e=s(2);l(),m(!(e.completedBy==null||e.completedBy.errors==null)&&e.completedBy.errors.required?1:-1),l(),m(!(e.completedBy==null||e.completedBy.errors==null)&&e.completedBy.errors.pattern?2:-1)}}function Je(n,t){n&1&&(i(0,"span"),o(1,"Phone no is required."),a())}function Qe(n,t){n&1&&(i(0,"span"),o(1," Enter a valid mobile number (with or without +91) "),a())}function Xe(n,t){if(n&1&&(i(0,"div",32),d(1,Je,2,0,"span"),d(2,Qe,2,0,"span"),a()),n&2){let e=s(2);l(),m(!(e.phone==null||e.phone.errors==null)&&e.phone.errors.required?1:-1),l(),m(!(e.phone==null||e.phone.errors==null)&&e.phone.errors.pattern?2:-1)}}function Ze(n,t){if(n&1&&(i(0,"span"),o(1),a()),n&2){let e=s(3);l(),p(" Remarks cannot exceed ",e.remarks==null||e.remarks.errors==null||e.remarks.errors.maxlength==null?null:e.remarks.errors.maxlength.requiredLength," characters. ")}}function et(n,t){if(n&1&&(i(0,"div",32),d(1,Ze,2,1,"span"),a()),n&2){let e=s(2);l(),m(!(e.remarks==null||e.remarks.errors==null)&&e.remarks.errors.maxlength?1:-1)}}function tt(n,t){if(n&1){let e=y();i(0,"div",6)(1,"div",16)(2,"div",17)(3,"form",18),u("ngSubmit",function(){f(e);let c=s();return x(c.onSubmitUpdateMaintenanceEntry())}),i(4,"div",19)(5,"h1",20),o(6," Edit Maintenance Entry "),a(),i(7,"button",21),u("click",function(){f(e);let c=s();return x(c.onCloseMaintenanceEntryModal())}),a()(),i(8,"div",22)(9,"div",23)(10,"span",24),o(11," Machine Name "),a(),i(12,"span",25),o(13),a()(),i(14,"div",26)(15,"span",24),o(16," Maintenance Category "),a(),i(17,"span",25),o(18),a()(),i(19,"div",27)(20,"div",28)(21,"label",29),o(22," Complete Date "),i(23,"span",30),o(24,"*"),a()(),v(25,"input",31),d(26,Be,3,2,"div",32),a(),i(27,"div",28)(28,"label",33),o(29," Next Maintenance Date "),i(30,"span",30),o(31,"*"),a()(),v(32,"input",34),d(33,je,3,2,"div",32),a(),i(34,"div",28)(35,"span",35),o(36," Completed By "),i(37,"span",30),o(38,"*"),a()(),v(39,"input",36),d(40,We,3,2,"div",32),v(41,"input",37),d(42,Xe,3,2,"div",32),a(),i(43,"div",28)(44,"label",38),o(45," Remarks "),a(),v(46,"textarea",39),d(47,et,2,1,"div",32),a()()(),i(48,"div",40)(49,"button",41),u("click",function(){f(e);let c=s();return x(c.onCloseMaintenanceEntryModal())}),o(50," Cancel "),a(),i(51,"button",42),o(52," Update "),a()()()()()()}if(n&2){let e=s();l(3),A("formGroup",e.meForm),l(10),p(" ",e.upsertMaintenanceEntryModalData==null?null:e.upsertMaintenanceEntryModalData.machineName," "),l(5),p(" ",e.upsertMaintenanceEntryModalData==null||e.upsertMaintenanceEntryModalData.alerts==null?null:e.upsertMaintenanceEntryModalData.alerts.categoryName," "),l(8),m(e.lastMaintenanceDate!=null&&e.lastMaintenanceDate.touched&&(e.lastMaintenanceDate!=null&&e.lastMaintenanceDate.errors)?26:-1),l(7),m(e.nextMaintenanceDate!=null&&e.nextMaintenanceDate.touched&&(e.nextMaintenanceDate!=null&&e.nextMaintenanceDate.errors)?33:-1),l(7),m(e.completedBy!=null&&e.completedBy.touched&&(e.completedBy!=null&&e.completedBy.errors)?40:-1),l(2),m(e.phone!=null&&e.phone.touched&&(e.phone!=null&&e.phone.errors)?42:-1),l(5),m(e.remarks!=null&&e.remarks.touched&&(e.remarks!=null&&e.remarks.errors)?47:-1)}}var H=class n{_coreService=_(w);_apiFs=_(N);_fb=_(q);meForm=this._fb.group({lastMaintenanceDate:["",[M.required,this.lastMaintenanceDateValidator.bind(this)]],nextMaintenanceDate:["",[M.required,this.nextMaintenanceDateValidator.bind(this)]],completedBy:["",[M.required,M.pattern("^(?!s*$).+")]],phone:["",[M.required,M.pattern("^(?:\\+91[-\\s]?|91[-\\s]?|0)?[6-9]\\d{9}$")]],remarks:["",[M.maxLength(500)]]});ngOnInit(){this.loadList()}maintenanceEntryList=[];loadList(){this._apiFs.maintenanceEntry.list().subscribe({next:t=>{t.code==="OK"&&(this.maintenanceEntryList=t.data||[])},error:t=>{}})}get lastMaintenanceDate(){return this.meForm?.get("lastMaintenanceDate")}get nextMaintenanceDate(){return this.meForm?.get("nextMaintenanceDate")}get completedBy(){return this.meForm.get("completedBy")}get phone(){return this.meForm.get("phone")}get remarks(){return this.meForm.get("remarks")}lastMaintenanceDateValidator(t){return this.nextMaintenanceDate?.updateValueAndValidity(),null}nextMaintenanceDateValidator(t){if(!this.lastMaintenanceDate)return null;let e=this.lastMaintenanceDate?.value,r=t.value;if(!e||!r)return null;let c=new Date(e);return new Date(r)<=c?{nextDateInvalid:!0}:null}upsertMaintenanceEntryModalData;isUpsertMaintenanceEntryModalOpen=!1;onOpenUpsertMaintenanceEntryModal(t,e){!t?.machineId||!e?._id||(this.upsertMaintenanceEntryModalData=k({},t),this.upsertMaintenanceEntryModalData.alerts=k({},e),this.meForm.patchValue({lastMaintenanceDate:(0,Q.default)().format("YYYY-MM-DD"),nextMaintenanceDate:(0,Q.default)().add(this.upsertMaintenanceEntryModalData?.alerts?.scheduleDays??1,"days").format("YYYY-MM-DD"),completedBy:"",phone:"",remarks:""}),this.isUpsertMaintenanceEntryModalOpen=!0)}isReqAlive=!1;onSubmitUpdateMaintenanceEntry(){if(this.isReqAlive||!this.upsertMaintenanceEntryModalData?.machineId)return;if(this.meForm.invalid){this.meForm.markAllAsTouched();return}this.isReqAlive=!0;let t=k({},this.meForm.value);t.completedBy=t.completedBy.trim(),t.phone=t.phone.trim(),t.remarks=t.remarks.trim(),this._apiFs.maintenanceEntry.update(this.upsertMaintenanceEntryModalData?.alerts?._id,t).subscribe({next:e=>{this.isReqAlive=!1,e.code==="OK"&&(this.loadList(),this.onCloseMaintenanceEntryModal(),this._coreService.utils.showToaster("success","Maintenance entry updated successfully."))},error:e=>{this.isReqAlive=!1;let r=e?.error?.message||"Something went wrong, please try again later.";this._coreService.utils.showToaster("danger",r)}})}onCloseMaintenanceEntryModal(){this.isUpsertMaintenanceEntryModalOpen=!1,this.upsertMaintenanceEntryModalData=null,this.meForm.reset({lastMaintenanceDate:"",nextMaintenanceDate:"",completedBy:"",phone:"",remarks:""})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=E({type:n,selectors:[["app-maintenance-entry"]],decls:9,vars:2,consts:[[1,"container-xxl","p-3","my-4","bg-white","shadow-sm","rounded-2","border"],[1,"text-capitalize","text-muted","fs-5","fw-bold","pt-0","border-bottom"],[1,"table-responsive"],[1,"grid-layout","gap-3"],[1,"rounded","border","border-2","border-success","border-opacity-75","user-select-none"],[1,"text-muted","small","text-center"],[1,"modal","d-block"],[1,"d-flex","align-items-center","gap-3","text-white","bg-success","rounded-top-1","p-2"],[1,"text-uppercase","fw-bold","lh-1","me-auto"],[1,"text-capitalize","fw-bold","lh-1"],[1,"p-1","w-100","d-flex","flex-column","gap-1"],[1,"d-flex","align-items-center","border","border-secondary","rounded-2","py-1","px-2","c-pointer"],[1,"d-flex","align-items-center","border","border-secondary","rounded-2","py-1","px-2","c-pointer",3,"click"],[1,"me-auto"],[1,"small","category-name"],[1,"fw-semibold"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content","shadow-lg"],[3,"ngSubmit","formGroup"],[1,"modal-header"],[1,"modal-title","fs-5"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"d-flex","align-items-center","justify-content-center"],[1,"text-secondary","me-auto"],[1,"fw-semibold","text-primary","text-capitalize"],[1,"d-flex","align-items-center","justify-content-center","mb-3"],[1,"row"],[1,"col-12","mb-3"],["for","lastMaintenanceDate",1,"form-label"],[1,"text-danger"],["type","date","id","lastMaintenanceDate","formControlName","lastMaintenanceDate",1,"form-control"],[1,"invalid-feedback","d-block"],["for","nextMaintenanceDate",1,"form-label"],["type","date","id","nextMaintenanceDate","formControlName","nextMaintenanceDate",1,"form-control"],[1,"form-label","d-block"],["type","text","formControlName","completedBy","placeholder","Enter name",1,"form-control"],["type","text","formControlName","phone","placeholder","Enter phone",1,"form-control","mt-2"],["for","remarks",1,"form-label"],["name","remarks","id","remarks","formControlName","remarks","placeholder","Enter remark",1,"form-control",2,"max-height","6lh"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary","me-3",3,"click"],[1,"btn","btn-primary"]],template:function(e,r){e&1&&(i(0,"div",0)(1,"h3",1),o(2," Maintenance Entry "),a(),i(3,"div",2)(4,"div",3),b(5,qe,9,2,"div",4,Le,!1,Pe,2,0,"span",5),a()()(),d(8,tt,53,8,"div",6)),e&2&&(l(5),S(r.maintenanceEntryList),l(3),m(r.isUpsertMaintenanceEntryModalOpen?8:-1))},dependencies:[P,L,I,F,O,V,R,oe],styles:[".grid-layout[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr))}.category-name[_ngcontent-%COMP%]{display:-webkit-box;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;line-clamp:1;-webkit-line-clamp:1;word-break:break-all}"]})};var tn=[{path:T.SETTINGS.MACHINE_GROUP,title:G.SETTINGS.MACHINE_GROUP,component:Y},{path:T.SETTINGS.MACHINE_CONFIGURE,title:G.SETTINGS.MACHINE_CONFIGURE,component:j},{path:T.SETTINGS.MAINTENANCE_CATEGORY,title:G.SETTINGS.MAINTENANCE_CATEGORY,component:K},{path:T.SETTINGS.MAINTENANCE_ENTRY,title:G.SETTINGS.MAINTENANCE_ENTRY,component:H},{path:T.PAGE_NOT_FOUND,title:G.PAGE_NOT_FOUND,component:re}];export{tn as routes};
